name: Create repo via issue form

run-name: Execute create repo request from @${{ github.actor }}

on:
    issues:
        types: 
            - opened
            - edited

jobs:
    create-repo:
        name: Create repo via issue-form
        runs-on: ubuntu-latest
        steps:
            - name: checkout repo
              uses: actions/checkout@v3

            - name: Create repo
              id: create_repo
              uses: actions/github-script@v6
              env:
                APP_ID: ${{ secrets.APP_ID }}
                APP_PRIVATE_KEY: ${{ secrets.APP_PRIVATE_KEY }}
                INSTALLATION_ID: ${{ secrets.INSTALLATION_ID }}
              with:
                script: | 
                  const { Octokit } = require("@octokit/rest");
                    const githubApp = new Octokit({
                      authStrategy: createAppAuth,
                      auth: {
                        appId: process.env.APP_ID,
                        privateKey: process.env.PRIVATE_KEY,
                        // optional: this will make appOctokit authenticate as app (JWT)
                        //           or installation (access token), depending on the request URL
                        installationId: process.env.INSTALLATION_ID
                      },
                    });
                  const script = require('${{github.workspace}}/main.js')
                  await script({githApp, context, core})

              